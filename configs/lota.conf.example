# /etc/lota/lota.conf -- LOTA Agent configuration
#
# Line-oriented key = value format.
# Lines starting with '#' are comments. Empty lines are ignored.
# Keys accept both underscore and hyphen forms (e.g: ca_cert, ca-cert).
# CLI flags override any value set here.
#
# To dump the effective configuration after loading this file:
#   lota-agent --dump-config
#   lota-agent --config /path/to/file --dump-config

# ---- Verifier connection ------------------------------------------------

# Verifier server address
server = localhost

# Verifier server port
port = 8443

# CA certificate for TLS verification (default: system CA store)
# ca_cert = /etc/lota/ca.pem

# Pin verifier certificate by SHA-256 fingerprint (64 hex chars)
# pin_sha256 = aabbccdd...

# ---- BPF / enforcement --------------------------------------------------

# Path to compiled BPF object file
bpf_path = /usr/lib/lota/lota_lsm.bpf.o

# Enforcement mode: monitor, enforce, maintenance
# Default is enforce.
# mode = enforce

# Strict policy flags (all default to true).
# strict_mmap = true
# strict_exec = true
# block_ptrace = true
# strict_modules = true
# block_anon_exec = true

# allow_verity: allow fs-verity protected files by digest.
# When strict_exec or strict_modules is enabled in enforce mode, the agent
# requires at least one allow_verity entry and will refuse to start otherwise.
#
# Each entry must be an absolute path and must refer to a file with fs-verity
# enabled. The agent measures the fs-verity digest at startup and provisions it
# into the BPF allowlist.
#
# allow_verity = /usr/bin/my_verified_binary
# allow_verity = /usr/lib/my_verified_module.ko

# ---- Attestation ---------------------------------------------------------

# Continuous attestation interval in seconds (0 = one-shot when --attest)
attest_interval = 0

# AIK key lifetime in seconds before rotation (0 = default 30 days)
aik_ttl = 0

# Optional absolute path to currently booted kernel image.
# Use this on distros that do not expose /boot/vmlinuz-<release>.
# kernel_path = /efi/EFI/Linux/linux.efi

# ---- Daemon --------------------------------------------------------------

# Fork to background (not needed under systemd)
daemon = false

# PID file location
pid_file = /run/lota/lota-agent.pid

# ---- Policy signing ------------------------------------------------------

# Ed25519 private key for signing policies
# signing_key = /etc/lota/policy.key

# Ed25519 public key for verifying policy signatures
# policy_pubkey = /etc/lota/policy.pub

# ---- Logging -------------------------------------------------------------

# Log level: debug, info, warn, error
log_level = info

# ---- Trusted libraries ---------------------------------------------------
# Multiple trust_lib entries are allowed (one per line).
# trust_lib = /usr/lib64/libc.so.6
# trust_lib = /usr/lib64/libssl.so.3

# ---- Protected PIDs ------------------------------------------------------
# Multiple protect_pid entries are allowed (one per line).
# protect_pid = 1234
# protect_pid = 5678
